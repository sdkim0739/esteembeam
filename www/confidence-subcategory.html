<!DOCTYPE html>
<html>
<html lang="en-US">

  <head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width"/>

    <link rel="stylesheet" type="text/css" href="css/confidence-subcategory.css">
    <link href="https://fonts.googleapis.com/css?family=Raleway" type="text/css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Catamaran" type="text/css" rel="stylesheet">

    <script src="https://use.fontawesome.com/37223d7631.js"></script>
    <script type="text/javascript" src="local-notification.js"></script>

    <title>Confidence-Subcategories</title>

  </head>

  <body>

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript">
        app.initialize();
    </script>

    <h1>Confidence Issues</h1>
    <h2>Low Confidence? Please describe what you're feeling.</h2>


    <button class="button" id="button1"><input type="checkbox" name="confidence" value="Stupid"> I Feel Like I'm Stupid<br></button>
    <button class="button" id="button2"><input type="checkbox" name="confidence" value="Not_Good_Enough"> I Feel Like I'm Not Good Enough<br></button>
    <button class="button" id="button3"><input type="checkbox" name="confidence" value="Unimportant"> I Feel Unimportant<br></button>
    <button class="button" id="button4"><input type="checkbox" name="confidence" value="Not_Outgoing"> I'm Not Outgoing Enough<br></button>
    <button class="button" id="button5"><input type="checkbox" name="confidence" value="Abilities"> I'm Not Confident in My Abilities<br></button>

    <a href="frequency-pg.html" onclick="storeMessage();return false;"><i class="fa fa-chevron-circle-right fa-3x" aria-hidden="true"></i></a>
    <a href="categories.html"><i class="fa fa-chevron-circle-left fa-3x" aria-hidden="true"></i></a>

    <script type="text/javascript">
    var message;

    var storeMessage =  function() {
        document.addEventListener('deviceready', function () {
             cordova.plugins.notification.local.registerPermission(function (granted) {
             });
             var subcatValue = [];
                   $.each($("input[type='checkbox']:checked"), function(){
                       subcatValue.push($(this).val());
                   });

               var subcatFilter = [];

               $.getJSON("https://sdkim0739.pythonanywhere.com/api/message/?format=json", function(result) {
             subcatValue.forEach(function(subcat) {
                     subcatFilter.push(result.objects.filter(function(msg) {
                          return msg.subcategory == subcat;
                       }));
                   });
                   message = subcatFilter[Math.floor(Math.random() * subcatFilter.length)][Math.floor(Math.random() * subcatFilter.length)].text;
               });
        });
    }
    </script>
  </body>

</html>
